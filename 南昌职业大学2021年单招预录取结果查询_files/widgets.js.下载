var dsLi;FilterWidget={fillOperations:function(f,d,b){var c={eq:"等于",ne:"不等于",gt:"大于",gte:"大于等于",lt:"小于",lte:"小于等于",bw:"以...开始",ew:"以...结束",ct:"包含",ctany:"包含...之一",nct:"不包含",cor:"包含...之一",cand:"包含",ceq:"等于",cne:"不等于","in":"在...中",nin:"不在...中"},a,e;if(b){a={basic:["eq","ne","bw","ew","ct","nct","in","nin"],map:["eq","ne","bw","ew","ct","nct"],number:["eq","ne","gt","gte","lt","lte"],goods:["eq","ne","gt","gte","lt","lte"],date:["eq","ne","gt","gte","lt","lte"],textarea:["eq","ne","bw","ew","ct","nct"],radio:["eq","in"],checkbox:["cand","cor","ceq","cne"],paystatus:["eq","ne"],verifystatus:["eq","ne"],"boolean":["eq","ne"]}}else{a={basic:["eq","ne","bw","ew","ct","nct","in","nin"],map:["eq","ne","bw","ew","ct","nct"],number:["eq","ne","gt","gte","lt","lte"],goods:["eq","ne","gt","gte","lt","lte"],date:["eq","ne","gt","gte","lt","lte"],textarea:["eq","ne","bw","ew","ct","nct"],radio:["eq","ne","in","nin"],checkbox:["cand","cor","ceq","cne"],paystatus:["eq","ne"],verifystatus:["eq","ne"],"boolean":["eq","ne"]}}if(d==="likert"||d==="dropdown"||d==="radio"||d==="dropdown2"){e=a.radio}else{if(d==="number"||d==="goods"||d==="money"||d==="time"||d==="filesize"||d==="grade"){e=a.number}else{if(d==="checkbox"){e=a.checkbox}else{if(d==="textarea"){e=a.textarea}else{if(d==="date"){e=a.date}else{if(d==="map"){e=a.map}else{if(d==="paystatus"){e=a.paystatus}else{if(d==="verifystatus"){e=a.verifystatus}else{if(d==="boolean"){e=a["boolean"]}else{e=a.basic}}}}}}}}}f.empty();$(e).each(function(h,g){f.append($.format('<option value="{0}">{1}</option>',g,c[g]))});f.treeSelectDom({width:"150px",lineHeight:"30px"});f.treeSelectDom("updateOpt")},fillAllFields:function(c,i){var b={fillChkDetail:false,fillCommonFields:false,linkParentField:false,fixed:false,isUp:false,flds:false,fillgoods:false,forcon:false};var a=$.extend(true,{},b,i);c.empty();c.append('<option style="display: none" remove="1"></option>');c.append('<option ftype="number" value="ID">ID</option>');var f,d=false;var h=a.flds||FLDS;$(h).each(function(r,s){if(s.TYP==="checkbox"){if(a.forcon){var w=[];$.each(s.ITMS,function(n,z){if(z.OTHER==="1"){return true}w.push(z.VAL)});var o=FilterWidget._unique(w).join("@-@");c.append($.format('<option ftype="checkbox" value="{0}" data-allowv="{2}">{1}</option>',s.FLDID,s.LBL,o))}else{if(a.fillChkDetail){f=$.tmpl('<optgroup label="${LBL}"></optgroup>',s);var m=[];$.extend(true,m,s.ITMS);var v=m[m.length-1];if(v.OTHER&&v.OTHER=="1"){m.pop()}$.tmpl('<option ftype="checkbox" value="${NM}">${VAL}</option>',m).appendTo(f);c.append(f)}else{c.append($.tmpl('<option ftype="checkbox" value="${FLDID}">${LBL}</option>',s))}}}else{if(s.TYP==="goods"){d=true;if(a.fillgoods){if(a.fillChkDetail){f=$.tmpl('<optgroup label="${LBL}"></optgroup>',s);$.each(s.ITMS,function(E,D){if(D.GGXH){var C=D.GGXH;var A=C.LVL;for(var z=1;z<=A;z++){var B=C["DD"+z];f.append($.tmpl('<option ftype="checkbox" value="${NM}">${LBL}</option>',{NM:B.NM,LBL:D.VAL+"("+B.LBL+")"}))}}f.append($.tmpl('<option ftype="goods" value="${NM}">${VAL}</option>',D))});c.append(f)}else{c.append($.tmpl('<option ftype="goods" value="${FLDID}">${LBL}</option>',s))}}}else{if(s.TYP==="address"){f=$($.tmpl('<optgroup label="${LBL}"></optgroup>',s));f.append($.format('<option ftype="address" value="{0}">{1}省/自治区/直辖市</option>',s.SUBFLDS.PRV.NM,a.linkParentField?s.LBL+"-":""));f.append($.format('<option ftype="address" value="{0}">{1}市</option>',s.SUBFLDS.CITY.NM,a.linkParentField?s.LBL+"-":""));f.append($.format('<option ftype="address" value="{0}">{1}区/县</option>',s.SUBFLDS.ZIP.NM,a.linkParentField?s.LBL+"-":""));f.append($.format('<option ftype="address" value="{0}">{1}详细地址</option>',s.SUBFLDS.DTL.NM,a.linkParentField?s.LBL+"-":""));c.append(f)}else{if(s.TYP==="dropdown2"){var l=1;var x=1;var j=FilterWidget._getDropdown2Allowv(s.ITMS);for(var k in s.SUBFLDS){c.append($.tmpl('<option ftype="dropdown2" value="${NM}" data-allowv="${ALLOW}">${LBL}</option>',{NM:s.SUBFLDS[k].NM,LBL:s.LBL+"("+(l++)+")",ALLOW:j[(x++)+""]}))}}else{if(s.TYP==="map"){c.append($.tmpl('<option ftype="map" value="${NM}">${LBL}</option>',{NM:s.SUBFLDS.TXT.NM,LBL:s.LBL}))}else{if(s.TYP==="file"){f=$($.tmpl('<optgroup label="${LBL}"></optgroup>',s));f.append($.format('<option ftype="file" value="{0}">{1}文件类型</option>',s.SUBFLDS.TYP.NM,a.linkParentField?s.LBL+"-":""));f.append($.format('<option ftype="filesize" value="{0}">{1}文件大小</option>',s.SUBFLDS.SZ.NM,a.linkParentField?s.LBL+"-":""));f.append($.format('<option ftype="file" value="{0}">{1}文件名称</option>',s.SUBFLDS.NM.NM,a.linkParentField?s.LBL+"-":""));c.append(f)}else{if(s.TYP==="likert"){f=$($.format('<optgroup label="{0}"></optgroup>',s.LBL));$.each(s.ITMS,function(A,n){var z=[];$.each(n.ITMS,function(C,D){z.push(D.VAL)});var B=FilterWidget._unique(z).join("@-@");$($.format('<option ftype="likert" value="{0}" data-allowv="{2}">{1}</option>',n.NM,n.LBL,B)).appendTo(f)});c.append(f)}else{if(s.TYP==="table"){}else{if(s.TYP==="radio"){var y=[];$.each(s.ITMS,function(z,n){y.push(n.VAL)});var t=FilterWidget._unique(y).join("@-@");c.append($.format('<option ftype="{0}" value="{1}" data-allowv="{3}">{2}</option>',s.TYP,s.NM,s.LBL,t))}else{if(s.TYP==="dropdown"){var q=[];$.each(s.ITMS,function(z,n){q.push(n.VAL)});var u=FilterWidget._unique(q).join("@-@");c.append($.format('<option ftype="{0}" value="{1}" data-allowv="{3}">{2}</option>',s.TYP,s.NM,s.LBL,u))}else{if(s.NM){c.append($.tmpl('<option ftype="${TYP}" value="${NM}">${LBL}</option>',s))}}}}}}}}}}}});if(d){c.append('<option ftype="money" value="AMT">金额</option>');c.append('<option ftype="paystatus" value="PAYSTATUS">在线支付状态</option>');c.append('<option ftype="text" value="TRADEID">交易流水号</option>')}var e=window.FRM||window.F||{};if("1"==e.VERIFY){c.append('<option ftype="verifystatus" value="VERIFYSTATUS">核销状态</option>');c.append('<option ftype="text" value="VERIFYID">核销码</option>');c.append('<option ftype="date" value="VERIFYDATE">核销日期</option>');c.append('<option ftype="date" value="VERIFYEXPDATE">核销过期日期</option>');c.append('<option ftype="text" value="VERIFYBY">核销人</option>')}if("1"==e.EX){c.append('<option ftype="text" value="EX">扩展属性</option>')}if("1"==e.COUPON){c.append('<option ftype="text" value="COUPONCODE">优惠码</option>')}if(a.fillCommonFields){if($.isArray(a.fillCommonFields)){this._fillCommonFields(c,a.fillCommonFields)}else{this._fillCommonFields(c)}}var g={width:"200px",lineHeight:"30px",showFilter:true,delIcon:true,needTitle:true};if(a.fixed){g.fixed=true}if(a.isUp){g.direction="up"}c.treeSelectDom(g);c.treeSelectDom("updateOpt")},getConditions:function(c){var b={money:"number",goods:"number",grade:"number",number:"number",date:"date",time:"time",filesize:"filesize"},e=[],a,d;$("li.conditions",c).each(function(j,f){d=$(f).find("select.conditionSelect");if(d.length>0){var h=b[d.find("option:selected").attr("ftype")];if(d.val()){if($.isObjectId(d.val())){if(FLDS){var g=$(f).find(":text.conditionValue").val();if(!g){return true}var l=g.split(";");$.each(FLDS,function(i,n){if(n.FLDID===d.val()){var o={};var m=$(f).find("select.compareType").val();if(m==="cor"){o.or=[]}else{if(m==="cand"){o.and=[]}}$.each(n.ITMS,function(q,s){if($.inArray(s.VAL,l)>=0){var r={FLD:"",VAL:"",CTYP:"eq",DTYP:"string",LBL:""};r.FLD=s.NM;r.VAL=s.VAL;r.LBL=$(f).find(".tree-names").eq(0).text();if(m==="cor"){o.or.push(r)}else{if(m==="cand"){o.and.push(r)}}}});e.push(o);return false}})}else{console.error("没有表单字段")}}else{var k=$(f).find(".conditionSelect").next().find(">input").data("selecteds")[0];a={FLD:d.val(),DTYP:h===undefined?"string":h,CTYP:$(f).find("select.compareType").val(),VAL:$(f).find(":text.conditionValue").val(),LBL:k?k.name:""};if(d.val()=="VERIFYSTATUS"||d.val()=="STAR"||d.val()=="PROCESSED"||d.val()=="PAYSTATUS"){a.VAL=$(f).find(".booleanstatus select").val()}e.push(a)}}}});return e},getMatchType:function(){return $("#anyallSelect").val()},initFilters:function(a,b){if(!b){b=$("#dsUL")}$("#filterType").change(function(){if($(this).val()==="all"){$("#dataSource").addClass("middle");b.find("li.conditionType,li.conditions").addClass("hide")}else{$("#dataSource").removeClass("middle");b.find("li.conditionType,li.conditions").removeClass("hide");b.find("li.conditions:gt(0)").remove();var c=b.find("li.conditions:eq(0)");c.find("select.compareType").empty();c.find("select.compareType").treeSelectDom("updateOpt");c.find(":input").val("")}});b.on("change","select.conditionSelect",function(){var d=$(this).parent().parent();var i=d.find(("select.compareType"));var h=$(this).find("option:selected").attr("ftype");d.find(".booleanstatus").remove();var e=$(this).val();if(e=="STAR"||e=="PROCESSED"||e=="VERIFYSTATUS"||e=="PAYSTATUS"){var g=$(this).val();var f={STAR:{Y:"标星",N:"未标星"},PROCESSED:{Y:"已处理",N:"未处理"},VERIFYSTATUS:{Y:"已核销",N:"未核销",PART:"部分核销"},PAYSTATUS:{Y:"已支付",N:"未支付"}};var c="";if(g=="VERIFYSTATUS"){c=$.format("<span class='booleanstatus'><select ><option value='1'>{0}</option><option value='0'>{1}</option><option value='2'>{2}</option></select></span>",f[g].Y,f[g].N,f[g].PART)}else{c=$.format("<span class='booleanstatus'><select ><option value='1'>{0}</option><option value='0'>{1}</option></select></span>",f[g].Y,f[g].N)}if(e=="PAYSTATUS"){c=$.format("<span class='booleanstatus'><select ><option value='已支付'>{0}</option><option value='未支付'>{1}</option></select></span>",f[g].Y,f[g].N)}d.find("input.conditionValue").addClass("hide").after(c);$(".booleanstatus select").treeSelectDom({width:"140px",lineHeight:"30px"})}else{d.find("input.conditionValue").removeClass("hide")}FilterWidget.fillOperations(i,h,a);FilterWidget._fillConditionValue($(this),i);d.find(".conditionValue").val("")});b.on("change","select.compareType",function(){var c=$(this).parent().parent(),d=c.find(("select.conditionSelect"));FilterWidget._fillConditionValue(d,$(this));c.find("input.conditionValue").val("")});if(a){b.off("click","a.icononly-add");b.on("click","a.icononly-add",function(){var c=$(this).parent().parent(),e=$('<select class="andor"><option value="and">并且</option><option value="or">或者</option></select>'),d=$('<li class="conditions"><span class="indent"></span><span> <select name="FLD" class="fixed conditionSelect"></select> </span> <span> <select name="CTYP" class="compareType"></select> </span> <span><input name="VAL" type="text" class="text conditionValue"></span><span> <a class="icononly-add iconfont" title="添加一个新的过滤条件">&#xe63c;</a><a class="icononly-del iconfont" title="删除此过滤条件">&#xe63b;</a></span></li>');e.val(b.find("ul.dsUL").has(c).find("select.andor:eq(0)").val());FilterWidget.fillAllFields(d.find("select.conditionSelect"),{fillChkDetail:true,fillCommonFields:false,forcon:true});d.find("select.conditionSelect").find("option[value='ID']").remove();d.find(".indent").html(e);c.after(d);d.find("select.compareType").treeSelectDom({width:"150px",lineHeight:"30px"});e.treeSelectDom({width:"80px",lineHeight:"30px"})});b.on("click","a.icononly-del",function(){var c=$(this).parent().parent(),e=c.index(),d=c.parent();if(d.find(">li.conditions").length<=1){$.openGlobalNotice("最少保留1个条件。","error");return}c.remove();d.find("li.conditions:first").find("span.indent").text("如果")});b.find("select.conditionSelect").each(function(c,d){FilterWidget.fillAllFields($(d),{fillChkDetail:true,fillCommonFields:false,forcon:true})})}else{b.off("click","a.icononly-add");b.on("click","a.icononly-add",function(){var c=$(this).parent().parent(),d=$('<li class="conditions"><span> <select name="FLD" class="fixed conditionSelect"></select> </span> <span> <select name="CTYP" class="compareType"></select> </span> <span> <input name="VAL" type="text" class="text conditionValue"></span><span> <a class="icononly-add iconfont" title="添加一个新的过滤条件">&#xe63c;</a><a class="icononly-del iconfont" title="删除此过滤条件">&#xe63b;</a></span></li>');FilterWidget.fillAllFields(d.find("select.conditionSelect"),{fillChkDetail:true,fillCommonFields:true,forcon:true});c.after(d);d.find("select.compareType").treeSelectDom({width:"150px",lineHeight:"30px"})});b.on("click","a.icononly-del",function(){var c=$(this).parent().parent(),d=c.parent();if(d.find("li.conditions").length<=1){$.openGlobalNotice("最少保留1个条件。","error");return}c.remove()});FilterWidget.fillAllFields(b.find("select.conditionSelect:eq(0)"),{fillChkDetail:true,fillCommonFields:true,forcon:true})}},setValues:function(e,f){var a,d;if(!f){f=$("#dsUL")}f.find("li.conditions:gt(0)").remove();f.find("li.conditions:eq(0)").find(".conditionValue").removeAttr("style");var b=[];$(e).each(function(h,c){if(c.or||c.and){var g={FLD:"",DTYP:"string",VAL:"",CTYP:""};if(c.or&&c.or.length>0){g.CTYP="cor";var k=FilterWidget._getFldidByNm(c.or[0]["FLD"]);if(k){g.FLD=k;var l="";$.each(c.or,function(n,j){if(n===0){l+=j.VAL}else{l+=(";"+j.VAL)}});g.VAL=l;b.push(g)}}else{if(c.and&&c.and.length>0){g.CTYP="cand";var i=FilterWidget._getFldidByNm(c.and[0]["FLD"]);if(i){g.FLD=i;var m="";$.each(c.and,function(n,j){if(n===0){m+=j.VAL}else{m+=(";"+j.VAL)}});g.VAL=m;b.push(g)}}}}else{b.push(c)}});$(b).each(function(l,g){if(l>0){a=dsLi.clone();a.find("a.icononly-del").show();f.append(a)}else{a=f.find("li.conditions:eq(0)");if(!dsLi){dsLi=a.clone()}}a.find(":text.conditionValue").datetimepicker("destroy");a.find(":text.conditionValue").mutiselectedit("destroy");var k=a.find("select.conditionSelect"),j=a.find("select.compareType"),n=a.find(":text.conditionValue");k.val(g.FLD);j.removeClass("dateSelect");d=k.find("option:selected").attr("ftype");FilterWidget.fillOperations(j,d);j.val(g.CTYP);n.val(g.VAL);a.find(".booleanstatus").remove();if(g.FLD=="VERIFYSTATUS"||g.FLD=="STAR"||g.FLD=="PROCESSED"||g.FLD=="PAYSTATUS"){var m=g.FLD;var h={STAR:{Y:"标星",N:"未标星"},PROCESSED:{Y:"已处理",N:"未处理"},VERIFYSTATUS:{Y:"已核销",N:"未核销",PART:"部分核销"},PAYSTATUS:{Y:"已支付",N:"未支付"}};var c="";if(m=="VERIFYSTATUS"){c=$.format("<span class='booleanstatus'><select ><option value='1'>{0}</option><option value='0'>{1}</option><option value='2'>{2}</option></select></span>",h[m].Y,h[m].N,h[m].PART)}else{c=$.format("<span class='booleanstatus'><select ><option value='1'>{0}</option><option value='0'>{1}</option></select></span>",h[m].Y,h[m].N)}if(g.FLD=="PAYSTATUS"){c=$.format("<span class='booleanstatus'><select ><option value='已支付'>{0}</option><option value='未支付'>{1}</option></select></span>",h[m].Y,h[m].N)}n.addClass("hide").after(c);if(g.VAL=="1"){$(".booleanstatus select").val("1")}else{if(g.VAL=="0"){$(".booleanstatus select").val("0")}else{if(g.VAL=="已支付"){$(".booleanstatus select").val("已支付")}else{if(g.VAL=="未支付"){$(".booleanstatus select").val("未支付")}}}}$(".booleanstatus select").treeSelectDom({width:"140px",lineHeight:"30px"})}else{n.removeClass("hide")}FilterWidget._fillConditionValue(k,j);k.treeSelectDom({width:"200px",lineHeight:"30px"});k.treeSelectDom("updateOpt");j.treeSelectDom({width:"150px",lineHeight:"30px"});j.treeSelectDom("updateOpt")})},_getFldidByNm:function(a){var e="";if(FLDS){co:for(var c=0;c<FLDS.length;c++){if(FLDS[c].TYP==="checkbox"){var d=FLDS[c].ITMS;for(var b=0;b<d.length;b++){if(d[b]["NM"]===a){e=FLDS[c].FLDID;break co}}}}}else{console.error("当前无表单字段参数，无法获取对应FILDID")}return e},getCommonFields:function(){var a=[];a.push({TYP:"text",NM:"IP",LBL:"IP地址"});a.push({TYP:"text",NM:"CBY",LBL:"创建人"});a.push({TYP:"date",NM:"CDATE",LBL:"创建日期"});a.push({TYP:"text",NM:"UPBY",LBL:"最后修改人"});a.push({TYP:"date",NM:"UPTIME",LBL:"最后修改时间"});a.push({TYP:"number",NM:"TMOUT",LBL:"填写耗时(秒)"});a.push({TYP:"boolean",NM:"STAR",LBL:"标星状态"});a.push({TYP:"boolean",NM:"PROCESSED",LBL:"处理状态"});return a},_fillCommonFields:function(d,c){var b=$('<optgroup label="其他信息"></optgroup>');var a=FilterWidget.getCommonFields();if(c){a=a.concat(c)}$(a).each(function(e,g){b.append($.format('<option ftype="{0}" value="{1}">{2}</option>',g.TYP,g.NM,g.LBL))});d.append(b)},_fillConditionValue:function(g,c){var b=g.find("option:selected"),n=b.attr("ftype"),e=g.val(),l=c.val(),m=b.val(),q=g.parent().parent(),k=q.find(":text.conditionValue");k.datetimepicker("destroy");k.mutiselectedit("destroy");if(n==="date"){q.find("input.conditionValue").attr("autocomplete","off").datetimepicker({format:"Y-m-d",allowBlank:true,timepicker:false,lang:"ch",validateOnBlur:false,dynamic:true,onShow:function(r,s){s.addClass("datetimeopen")},onClose:function(r,s){s.removeClass("datetimeopen")}});q.find(".conditionValue").prop("readonly",false);q.find("a.icononly-add").css({"margin-left":"3px"});q.find("a.icononly-del").css({"margin-left":"23px"})}else{if(n==="time"){q.find(".conditionValue").prop("readonly",false);q.find("a.icononly-add").css({"margin-left":"3px"});q.find("a.icononly-del").css({"margin-left":"23px"})}else{if(n==="text"||n==="name"||n==="email"){var a=["--------","#{当前登录用户名}","#{当前用户真实姓名}","#{当前用户所在用户组}"];var f={only:true,fldlbls:a};if(l==="in"||l==="nin"){f.only=false}q.find(".conditionValue").prop("readonly",false);q.find(".conditionValue").attr("autocomplete","off").mutiselectedit(f);q.find("a.icononly-add").css({"margin-left":"3px"});q.find("a.icononly-del").css({"margin-left":"23px"})}else{if(n==="dropdown"||n==="dropdown2"||n==="radio"||n==="likert"){var i=b.data("allowv");var j=i.split("@-@");if(n==="dropdown"||n==="radio"){j.push("--------");j.push("#{当前登录用户名}");j.push("#{当前用户真实姓名}");j.push("#{当前用户所在用户组}")}var h={only:true,fldlbls:j};if(l=="eq"||l=="ne"){h.only=true}else{h.only=false}q.find(".conditionValue").prop("readonly",false);q.find(".conditionValue").attr("autocomplete","off").mutiselectedit(h);q.find("span.selectTime").hide();q.find("a.icononly-curuser").remove()}else{if(n==="checkbox"){var o=b.data("allowv");var d=o.split("@-@");q.find(".conditionValue").prop("readonly",true);q.find(".conditionValue").attr("autocomplete","off").mutiselectedit({fldlbls:d})}else{q.find(".conditionValue").prop("readonly",false);q.find("span.selectTime").hide();q.find("a.icononly-add").css({"margin-left":"3px"});q.find("a.icononly-del").css({"margin-left":"23px"})}}}}}if(n==="filesize"){if(q.find("span.unit").length===0){k.after("<span class='unit'> MB </span>")}}else{q.find("span.unit").remove()}if(l==="in"||l==="nin"){k.attr("placeholder",'多个值以";"隔开')}else{k.removeAttr("placeholder");if(n==="date"){k.attr("title","日期格式：YYYY-MM-DD")}else{if(n==="time"){k.attr("title","时间格式：HH:MM:SS")}else{if(n==="filesize"){k.attr("title","单位：MB")}else{k.attr("title","")}}}}},_unique:function unique(b){var a=[],d={};for(var c=0;c<b.length;c++){if(!d[b[c]]){a.push(b[c]);d[b[c]]=1}}return a},_getDropdown2Allowv:function(b){var c={"1":[],"2":[],"3":[],"4":[]};function a(d,e){if(!d||e>4){return}$.each(d,function(f,g){c[e+""].push(g.VAL);a(g.ITMS,e+1)})}a(b,1);c["1"]=FilterWidget._unique(c["1"]).join("@-@");c["2"]=FilterWidget._unique(c["2"]).join("@-@");c["3"]=FilterWidget._unique(c["3"]).join("@-@");c["4"]=FilterWidget._unique(c["4"]).join("@-@");return c}};$.widget("jsform.userselect",{options:{showbind:false,valuefield:"USERNAME",onconfirm:function(){}},getTexts:function(){return this.element.data("txts")||[]},getValues:function(){return this.element.data("vals")||[]},setValues:function(a){return this.element.data("vals",a)},_create:function(){var a=$("#overlay"),c=$("#divUsers"),g=this,b=this.options,d=this.element;if(a.length==0){a=$('<div id="overlay" class="overlay hide"></div>');$("body").append(a)}if(c.length==0){c=$('<div id="divUsers" class="lightbox ss hide"><div class="lbcontent"><div class="close-holder"><a class="iconfont close" href="#">&#xe63e;</a></div><div class="lbcontent--title">选择用户</div><div class="lbcontent--inner"><ul class="tree"></ul><div class="btns">	<a href="#" class="btn confirm blue">确定</a></div></div></div></div>');$("body").append(c)}if(c.draggable){c.draggable({handle:("div.close-holder")})}d.click(function(){g._openWindow()});c.find("a.confirm").click(function(){var i=[],h=[];c.find("input.val:checked").each(function(l,k){var j=$(k);i.push(j.val());h.push(j.attr("text"))});d.data("txts",h);d.data("vals",i);if(b.onconfirm){b.onconfirm()}g._closeWindow();return false});var e=$("#divUsers").find("li.l1");e.find("i").live({click:function(){var h=$(this).parent().parent(),i=h.find("ul");if(i.is(":visible")){i.slideUp("fast");$(this).html("&#xe68d;")}else{i.slideDown("fast");$(this).html(" &#xe72b;")}}});e.find(":checkbox.grp").live({click:function(){var j=$(this),h=j.parent().parent().parent(),i=h.find("ul");i.find(":checkbox").each(function(l,k){if(!$(k).prop("disabled")){$(k).prop("checked",j.prop("checked"))}})}});var f=$("#divUsers").find("li.l2");$(f).find(":checkbox").live({click:function(){if(!$(this).prop("checked")){$("#divUsers").find("li.l1").has(this).find(":checkbox.grp").prop("checked",false)}else{var i=$(this).closest("li.l2").siblings("li.l2");var h=true;$.each(i,function(j,k){if(!$(k).find("input.val:checkbox").prop("checked")){h=false;return false}});if(h){$("#divUsers").find("li.l1").has(this).find(":checkbox.grp").prop("checked",true)}}}});$("#divUsers a.close").click(function(){g._closeWindow();return false});$.showStatus("正在加载数据...");$.postJSON("/app/user/getalluser",{USERTYPE:b.valuefield},function(i){var j=i.DEPT||[],k=i.USER||[];j.splice(0,0,{_id:"",DEPT:"未分组"});var h=c.find("ul.tree").empty();$.each(j,function(m,q){var l='<li class="l1"><div><i class="iconfont gray">&#xe72b;</i><div class="pretty-box" style="display: inline-block"><input type="checkbox" class="grp" id="{0}"/><label for="{0}">{1}</label></div></div></li>',o="";$.each(k,function(s,r){if((r.DEPT||"")==q._id||r.DEPT==q.DEPT){var t='<li class="l2 {0}"><div class="pretty-box" style="display: inline-block"><input type="checkbox" {0} class="val" value="{1}" text="{2}" id="{3}"/><label for="{3}">{2}</label></div></li>';if(b.valuefield=="WXID"){var v="";if(b.showbind){if(r.CANCELSCRIBE){v="(已退订)"}else{if(!r.WXID){v="(未绑定微信)"}}}o+=$.format(t,b.showbind&&(!r.WXID||r.CANCELSCRIBE)?"disabled":"",r[b.valuefield]||"",(r.REALNAME?r.REALNAME:r.USERNAME)+v,$.getUUID(15,16))}else{if(b.valuefield=="DTID"&&r.REALNAME){o+=$.format(t,b.showbind&&!r.DTID?"disabled":"",r[b.valuefield]||"",(r.REALNAME?r.REALNAME:(r.USERNAME==r.DTID?"":r.USERNAME))+(""),$.getUUID(15,16))}}}});if(o){var n=$($.format(l,$.getUUID(15,16),q.DEPT));n.append("<ul>"+o+"</ul>");h.append(n)}});$.hideStatus()})},_closeWindow:function(){var a=$("#overlay"),b=$("#divUsers");a.addClass("hide");b.addClass("hide")},_openWindow:function(){var a=$("#overlay"),b=$("#divUsers"),d=this;a.removeClass("hide");b.removeClass("hide");var c=d.getValues();b.find("input.val").each(function(f,e){$(e).prop("checked",$.inArray($(e).val(),c)>=0&&!$(e).prop("disabled"))});a.removeClass("hide");b.removeClass("hide")}});$.widget("jsform.mutiselect",{options:{items:[],values:[],placeholder:"",click:function(){}},getValues:function(){return this.element.data("values")},setValues:function(a){if(!(a instanceof Array)){a=[a]}this.options.values=a;this._setSelected()},_init:function(){var c=this.element,b=this.options;var d=c.parent().find("div.mutiselect");if(arguments.length==0){b.items=[];c.find("option").each(function(f,e){var g=$(e);if(g.val()){b.items.push({VAL:g.val(),TXT:g.text()})}})}var a=c.parent().find(".mutiselect-items");if(a.length==0){a=$('<div class="mutiselect-items hide"></div><ul class="mutiselect-items-ul"></ul>');d.append(a)}else{a.find(".mutiselect-items-ul").empty()}$.each(b.items,function(e,f){a.find(".mutiselect-items-ul").append($.format('<li><input type="checkbox" value="{0}" text="{1}" {2} id="{3}"/><label title="{1}" for="{3}"> {1}</label></li>',f.VAL,f.TXT,$.inArray(f.VAL,b.values)>=0?"checked":"",$.getUUID(15,16)))});a.width(d.outerWidth()-2);a.position({my:"left top",at:"left bottom",of:d});this._setSelected()},_create:function(){var d=this.element,c=this.options;if(!c.placeholder){c.placeholder=d.attr("placeholder")||""}var e=$('<div class="mutiselect pretty-box"><input type="text" placeholder="'+c.placeholder+'" readonly class="txt"/><i class="trigger"></i></div>');var a=e.find("input.txt");a.width(d.width()-25);d.hide();d.parent().append(e);var b=d.parent().find(".mutiselect-items");if(b.length==0){b=$('<div class="mutiselect-items hide"><ul class="mutiselect-items-ul"></ul></div>');e.append(b)}e.on("click",d.parent(),function(g){var f=d.parent().find(".mutiselect-items");if(f.is(":visible")){f.addClass("hide");e.removeClass("open")}else{e.addClass("open");f.removeClass("hide");f.width($(this).outerWidth());f.position({my:"left top",at:"left bottom",of:e});if(f.mCustomScrollbar){f.find(".mutiselect-items-ul").mCustomScrollbar()}}g.stopPropagation()});b.unbind("click").bind({click:function(i){var g=$(this),h=[],f=[];g.find(":checkbox:checked").each(function(l,k){var j=$(k);f.push(j.attr("text"));h.push(j.val())});a.val(f.join(","));d.data("values",h);c.click(h);i.stopPropagation()}});$(document).click(function(f){var g=f.srcElement?f.srcElement:f.target;if($(g).hasClass("mCSB_dragger")||$(g).hasClass("mCSB_dragger_bar")){return}if(!$(g).is(".mutiselect-items li")){$(".mutiselect-items").addClass("hide").closest(".mutiselect").removeClass("open")}})},_setSelected:function(){var f=this.element,d=this.options,c=f.parent(),a=f.parent().find("div.mutiselect").find("input.txt");var b=[],e=[];c.find(":checkbox").each(function(j,h){var g=$(h),k=$.inArray(g.val(),d.values)>=0;g.prop("checked",k);if(k){b.push(g.attr("text"));e.push(g.val())}a.val(b.join(","));f.data("values",e)})}});$.widget("jsform.poptip",{options:{position:"bottom"},_create:function(){var a=this.element,b=this;a.on({mouseenter:function(){if(!a.attr("poptip")){return false}b._showPopTip();$("#poptip").css({marginTop:"5px"})},mouseleave:function(){b._hidePopTip();$("#poptip").css({marginTop:"0px"})}})},_showPopTip:function(){var b=this.options,c=this.element;if($("#poptip").length==0){$("body").append('<div id="poptip" class="poptip"><span class="poptip-text"></span></div>')}var a=$("#poptip").find("span.poptip-text");a.text(c.attr("poptip"));if("top"==b.position){$("#poptip").show().position({of:c,at:"left bottom",my:"left top"})}else{if("bottom"==b.position){$("#poptip").show().position({of:c,at:"left top",my:"left bottom"})}}},_hidePopTip:function(){$("#poptip").hide()}});$.widget("jsform.dropKick",{options:{width:"250px",lineHeight:"30px",direction:"down",fixed:false,nt:false,change:function(){},selectclick:function(){}},_create:function(){var a=this.element;a.hide();this.createProxy()},createProxy:function(){var h=this.element;var i=h.prop("disabled");var a=this.options;var c=h.next(".dk-select");if(c.length){c.remove()}var g=h.find("option:selected");var d=$('<div class="dk-select"><div class="dk-selected"></div><div class="dk-options-wrap"><ul class="dk-select-options"></ul></div></div>');var e=d.find(".dk-select-options");var b=h.find("option").length;if(!b){h.append('<option value="">&nbsp;</option>')}d.find(".dk-selected").html(g.text()||"&nbsp;");if(a.nt){d.find(".dk-selected").attr("title",g.text()||"")}var f=h.children();f.each(function(k,t){if(t.tagName==="OPTGROUP"){var n=$(t).children("option"),l=$('<li class="dk-optgroup"><div class="dk-optgroup-lable">'+$(t).attr("label")+'</div><ul class="dk-optgroup-options"></ul></li>'),o=l.find(".dk-optgroup-options");n.each(function(w,y){var z=$(y).val(),u=$(y).text()||"&nbsp;",v=$(y).is(g),x=v?" dk-option-selected":" ";var A=$(t).prop("disabled")?" dk-option-disabled":" ";if(a.nt){o.append('<li class="dk-option'+x+A+'" title="'+u+'" data-value="'+z+'">'+u+"</li>")}else{o.append('<li class="dk-option'+x+A+'" data-value="'+z+'">'+u+"</li>")}});e.append(l)}else{if(t.tagName==="OPTION"){var r=$(t).val(),s=$(t).text()||"&nbsp;",j=$(t).is(g),q=j?" dk-option-selected":" ";var m=$(t).prop("disabled")?" dk-option-disabled":" ";if(a.nt){e.append('<li class="dk-option'+q+m+'" title="'+s+'" data-value="'+r+'">'+s+"</li>")}else{e.append('<li class="dk-option'+q+m+'" data-value="'+r+'">'+s+"</li>")}}}});d.css({width:a.width,"line-height":a.lineHeight});h.after(d);if(i){d.addClass("dk-select-disabled");return}this._bindEvent()},_bindEvent:function(){var d=this;var a=this.element;var c=this.options;var b=a.next(".dk-select");var f=b.find(".dk-selected");var e=b.find(".dk-select-options");f.on("click",function(g){var h=$(".dk-select");$.each(h,function(j,k){if($(k).hasClass("open")&&!$(k).is(b)){$(k).removeClass("open");$(k).find(".dk-options-wrap").hide()}});if(b.hasClass("open")){$.proxy(d.close,d)()}else{$.proxy(d.open,d)()}if(c.selectclick){c.selectclick()}g.stopPropagation()});e.on("mouseover",".dk-option",function(g){e.addClass("dk-select-options-highlight");$(this).addClass("dk-option-highlight")});e.on("mouseout",".dk-option",function(g){$(this).removeClass("dk-option-highlight")});e.on("mouseleave",function(){e.removeClass("dk-select-options-highlight")});e.on("click",".dk-option",function(j){var i=$(this);var g=i.attr("data-value");var h=i.text();if(!i.hasClass("dk-option-disabled")){f.text(h);if(c.nt){f.attr("title",h)}e.find(".dk-option").siblings(".dk-option").removeClass("dk-option-selected");i.addClass("dk-option-selected");a.val(g);a.trigger("change");if($.type(c.change)==="function"){d._trigger("change")}f.clearErrorFlag();e.clearErrorFlag();f.removeClass("error")}$.proxy(d.close,d)();j.stopPropagation()});if(!this._isHasBind(document,"click","dropkick")){$(document).on("click.dropkick",function(g){if($(g.target).hasClass("mCSB_dragger")||$(g.target).hasClass("mCSB_dragger_bar")){return}var h=$(".dk-select");$.each(h,function(j,k){if($(k).hasClass("open")){$(k).removeClass("open");$(k).find(".dk-options-wrap").hide()}})})}},_isHasBind:function(f,e,d){var b=false;var a=$(f).data("events")[e];if(a){for(var c=0;c<a.length;c++){if(a[c].namespace===d){b=true;break}}}return b},open:function(){var a=this.element;var e=this.options;a.next(".dk-select").addClass("open");var c=a.next(".dk-select").find(".dk-options-wrap");var f=a.next(".dk-select");if(e.fixed){var b=a.next(".dk-select").outerWidth();c.width(b).css({position:"fixed"})}c.show();if(e.direction=="down"){c.position({my:"left top",at:"left bottom",of:f})}else{c.css({bottom:"100%"})}var d=a.next(".dk-select").find("ul.dk-select-options");if(d.mCustomScrollbar){d.mCustomScrollbar()}},close:function(){var a=this.element;var b=a.next(".dk-select");b.removeClass("open");var c=b.find(".dk-options-wrap");c.hide();c.removeClass("dk-select-options-highlight");c.find(".dk-option").removeClass("dk-option-highlight")},updateOpt:function(){this.createProxy()}});$.widget("jsform.treeSelect",{options:{width:"250px",lineHeight:"30px",treeData:{},value:[],multiple:false,leafOnly:true,unfold:false,html:false,nameProperty:"name",valueProperty:"value",childProperty:"items",enableProperty:"enable",showFilter:false,closeSelector:".vuedals-container",fullPath:false,delIcon:true,optionItem:"object",filterWorld:"输入关键字搜索",needTitle:false,direction:"down",selectTip:"",fixed:false,disabled:false,treeChange:function(a){},selectclick:function(a){},},_isTree:false,_create:function(){var e=this;var c=$(e.element);var b=e.options.valueProperty;e.options._unfold=e.options.unfold;var g=this._buildnodedata();var f=g.treeNodes;var d=g.selecteds;var a=[];d.forEach(function(h){a.push(h[b])});c.data("nodes",f);c.data("selecteds",d);c.data("value",a);e._renderDom();e._mountEvent();$(window).on("click",function(h){e.closePanel(h)});e.options.closeSelector&&$(e.options.closeSelector).on("click",function(h){e.closePanel(h)})},_init:function(){},_buildnodedata:function(){var k=this;var b=k.options;var f=b.valueProperty;var d=b.nameProperty;var a=b.childProperty;var m=b.value;var i=[];var g={};if(Array.isArray(b.treeData)){g[f]="_vroot_";if(typeof b.treeData[0]=="string"||typeof b.treeData[0]=="number"){var l=[];b.treeData.forEach(function(q){l.push({name:q+"",value:q})});g[a]=l}else{var o=$.extend(true,[],b.treeData);g[a]=o}}else{$.extend(true,g,b.treeData)}var c=0;var j=0;e(g,null);if((c>6||j>6)&&b.showFilter){k.options.showFilter=true}else{k.options.showFilter=false}function e(w,v){j++;if(k._nodeEnabled(w)===-1){w.del=true}w.tnEnable=(v&&!v.tnEnable)?false:k._nodeEnabled(w);w.show=true;if(!v){w.parent=null;w.tnDepth=0;w.isRoot=true;w.isLeaf=false;if(w[f]=="_vroot_"){w.tnDepth=-1;w.isUnflod=true}}else{w.parent=v;w.isRoot=false;w.isUnflod=k.options.unfold;if(w[a]&&w[a].length){w.isLeaf=false}else{w.isLeaf=true}if(v[f]=="_vroot_"){w.tnDepth=0}else{w.tnDepth=v.tnDepth+1}if(m||m===""){var s;if(Object.prototype.toString.call(m)==="[object Array]"){s=m}else{s=[m]}if(s.indexOf(w[f])>=0){var v=w.parent;w.tnSelected=true;w.isUnflod=true;var u=k._copyItem(w);var t=w[d];while(v){v.tnSelected=true;v.isUnflod=true;if(v[d]){t=v[d]+"-"+t}v=v.parent}u.fullPath=t;i.push(u)}else{w.tnSelected=false}}}if(!w.isLeaf){var r=w[a];if(r.length>c){c=r.length}for(var q=0;q<r.length;q++){e(r[q],w)}}}if(g.tnDepth==-1&&g[a]&&g[a].length>0){var n=g[a];for(var h=0;h<n.length;h++){if(n[h][a]&&n[h][a].length>0){k._isTree=true;break}}}else{if(g.tnDepth==0){if(g[a]&&g[a]>0){k._isTree=true}}}return{treeNodes:g,selecteds:i}},_searchData:function(e){var b=this;var d=b.options.childProperty;var c=$(b.element).data("nodes");if(e){b.options.unfold=true}a(c);function a(i){i.show=b._checkText(i,e);if(e&&i.show){i.isSearched=true}else{i.isSearched=false}if(!i.isLeaf){var g=i[d];for(var f=0;f<g.length;f++){a(g[f],i)}}if(i.show){var h=i.parent;while(h){h.show=true;h.isSearched=i.isSearched;h=h.parent}}}},_nodeEnabled:function(c){var b=true;var a=this.options.enableProperty;if(c.hasOwnProperty(a)&&c[a]==="-1"){return -1}if(c.hasOwnProperty(a)){b=c[a]!=="0"&&c[a]!=="-1"&&c[a]!==false}else{if(c.hasOwnProperty("isenable")){b=c.isenable!=="0"&&c.isenable!=="-1"&&c.isenable!==false}}return b},_checkText:function(a,c){var b=this.options.nameProperty;if(!c){return true}return Boolean(a[b]&&a[b].indexOf(c)>=0)},_copyItem:function(a){var c={};for(var b in a){if(b!==this.options.childProperty&&b!=="parent"){c[b]=a[b]}}return c},_renderDom:function(){var e=this;var h=$(e.element);var d=h.closest(".treeselect-warp");var b=$.tmpl("<div class='tree-names iconfont'><span class='selectTip'>${selectTip}</span></div>",{selectTip:e.options.selectTip});var f=$("<div class='name-out-warp'></div>");if(e.options.disabled){b.addClass("disabled");f.addClass("disabled")}var i=e._getNameTxt();if(i!==undefined){if(e.options.html){b.html(i)}else{b.text(i)}}d.css("width",e.options.width);if(e.options.delIcon&&!e.options.disabled){f.append("<span class='iconfont delIcon' title='清空'></span>")}b.appendTo(f);f.appendTo(d);var g=$("<div class='panel-warp'></div>");if(e.options.multiple){g.addClass("mul-tree")}else{g.addClass("radio-tree")}if(e.options.showFilter){$("<div class='filter-warp'><input type='text' class='search-input' name='filterWord' placeholder='"+e.options.filterWorld+"'></div>").appendTo(g)}var a=h.data("nodes");var c=$("<div class='panel-out-warp' style='display: none'><div class='panel-out'></div></div>");if(e.options.showFilter){c.find(".panel-out").css("maxHeight",32*5+40+"px")}else{c.find(".panel-out").css("maxHeight",32*5+"px")}c.find(".panel-out").append(g);c.appendTo(d);e._renderOption(a).appendTo(g)},_renderOption:function(d){if(d.del){return $("")}var m=this;var b=m.options;var e=b.valueProperty;var c=b.nameProperty;var a=b.childProperty;var g=$("<ul class='tree-ul'></ul>");if(d&&d[e]=="_vroot_"){var o=$("<li class='tree-li' style='display: none'></li>");o.data("node",d);o.appendTo(g)}else{var o=$("<li class='tree-li' style='background-color:"+d.bgcolor+";' value='"+d[e]+"'></li>");o.data("node",d);if(d.tnSelected){o.addClass("selected")}if(!m.options.leafOnly||d.isLeaf){o.addClass("tree-li-sel")}var n=$.tmpl("<label for='${value}' class='tree-lab'><span value='${value}'>${name}</span></label>",{value:d[e],name:d[c]});if(m.options.html){n.html(d[c])}if(!d.tnEnable){o.addClass("disabled")}if(m.options.needTitle){n.attr("title",d[c])}n.appendTo(o);if(!d.isLeaf){var j=false;if(d[a]){for(var h=0;h<d[a].length;h++){var k=d[a][h];if(k.show){j=true;break}}}n.addClass("tree-lab-switch");if((d.isUnflod||d.isSearched)&&j){o.prepend("<span class='iconfont tree-switch tree-open'></span>")}else{o.prepend("<span class='iconfont tree-switch tree-close'></span>")}}o.appendTo(g)}var l=0;var q=d.tnDepth<0?0:d.tnDepth;if(!m._isTree){l=8}else{l=q*16+(d.isLeaf?24:0)}o.css("paddingLeft",l+"px");if(d[a]&&d[a].length>0){for(var f=0;f<d[a].length;f++){m._renderOption(d[a][f]).appendTo(g)}}if(!d.isUnflod&&!d.isSearched){g.find(">.tree-ul").hide()}if(d.show){g.show()}else{g.hide()}return g},_getNameTxt:function(){var c=this;var a=c.options.fullPath;var e=c.options.nameProperty;var b=$(c.element).data("selecteds");var d;b.forEach(function(g,f){if(f==0){d=a?g.fullPath:g[e]}else{d+=","+(a?g.fullPath:g[e])}});return d},_mountEvent:function(){var d=this;var c=d.element;var f=d.options.childProperty;var a=c.closest(".treeselect-warp").find(".panel-warp").eq(0);function e(j){j.stopPropagation();var i=$(this).closest(".tree-ul");i.children(".tree-ul").show();i.find(">li .tree-switch").removeClass("tree-close").addClass("tree-open");var g=$(this).closest(".tree-li");var h=g.data("node");h.isUnflod=true}function b(j){j.stopPropagation();var i=$(this).closest(".tree-ul");i.children(".tree-ul").hide();i.find(">li .tree-switch").removeClass("tree-open").addClass("tree-close");var g=$(this).closest(".tree-li");var h=g.data("node");h.isUnflod=false}if(d.options.leafOnly){a.on("click",".tree-lab-switch",function(k){k.stopPropagation();var i=$(this).closest(".tree-ul");var j=i.find(">li .tree-switch");if(j.hasClass("tree-open")){i.children(".tree-ul").hide();i.find(">li .tree-switch").removeClass("tree-open").addClass("tree-close")}else{if(j.hasClass("tree-close")){i.children(".tree-ul").show();i.find(">li .tree-switch").removeClass("tree-close").addClass("tree-open")}}var g=$(this).closest(".tree-li");var h=g.data("node");h.isUnflod=false})}a.on("click",".tree-close",e).on("click",".tree-open",b).on("click",".tree-li-sel",function(i){i.stopPropagation();var g=$(this).closest(".tree-li").data("node");if(d.options.selectclick){d.options.selectclick(g)}if($(this).hasClass("disabled")){return}d._selectCurrent(this);var h=c.data("nodes");d._getSelectedValue(h);d._updateDom();if($.type(d.options.treeChange)==="function"){d._trigger("treeChange",i,d.getValues())}if(!d.options.multiple){setTimeout(function(){var j=c.next(".name-out-warp");j.find(".tree-names").removeClass("open");var k=j.next(".panel-out-warp");k.hide()},50)}}).on("input",".search-input",function(h){h.stopPropagation();var i=$(this).val();d._searchData(i);var g=d._renderOption(c.data("nodes"));a.find(".tree-ul").remove();a.append(g)});c.next(".name-out-warp").find(".tree-names").on("click",function(g){if($(this).hasClass("disabled")){return}if($(this).hasClass("open")){d.closePanel(g,true)}else{d.openPanel(g)}});c.next(".name-out-warp").find(".delIcon").on("click",function(i){i.stopPropagation();var h=c.data("nodes");g(h);d._getSelectedValue(h);d._updateDom();if($.type(d.options.treeChange)==="function"){d._trigger("treeChange",i,undefined)}function g(k){k.tnSelected=false;if(!k.isLeaf){for(var j=0;j<k[f].length;j++){g(k[f][j])}}}})},openPanel:function(c){var j=this.element;var b=this.options;var i=j.next(".name-out-warp");i.find(".tree-names").addClass("open");var a=i.next(".panel-out-warp");if(b.fixed){var h=i.outerWidth();a.width(h).css({position:"fixed"})}a.show();if(b.direction=="down"){a.position({my:"left top",at:"left bottom",of:i})}else{a.css({bottom:"100%"})}var g=j.parent().find(".panel-out");var d=g.find(".panel-warp").find(".tree-li.selected.tree-li-sel");var f=d[0]?d[0].offsetTop:0;if(a.find(".panel-out").mCustomScrollbar){a.find(".panel-out").mCustomScrollbar();if(f>180){a.find(".panel-out").mCustomScrollbar("scrollTo",{x:0,y:f-50+""},{scrollInertia:0})}}else{if(f>180){g[0].scrollTop=f-50}}this._closeOther()},closePanel:function(g,f){var b=this.element.parent();if(f){b=this.element.parent().find(".panel-out-warp")}if(!b.is(g.target)&&b.has(g.target).length===0){var d=this.element;var a=d.next(".name-out-warp");a.find(".tree-names").removeClass("open");var c=a.next(".panel-out-warp");c.hide()}},_closeOther:function(){var d=this.element;var e=d.next(".name-out-warp");var b=e.next(".panel-out-warp");var c=$(".treeselect-warp .name-out-warp").not(e[0]);var a=$(".treeselect-warp .panel-out-warp").not(b[0]);c.find(".tree-names").removeClass("open");a.hide()},_selectCurrent:function(h){var k=this;var m=$(k.element);var c=k.options.childProperty;var d=$(h).closest(".tree-li").data("node");var g=m.data("nodes");if(!k.options.multiple&&d.tnSelected){return}var f=!d.tnSelected;if(!k.options.multiple&&f){l(g)}var a=d;a.tnSelected=f;while(!a.isRoot){a=a.parent;if(k.options.multiple&&!f){var j=false;var b=a[c];for(var e=0;e<b.length;e++){if(b[e].tnSelected){j=b[e].tnSelected;break}}a.tnSelected=j;continue}a.tnSelected=f}function l(n){n.tnSelected=false;if(!n.isLeaf){var q=n[c];for(var o=0;o<q.length;o++){l(q[o])}}}},_getSelectedValue:function(f){var i=this;var l=$(i.element);var a=i.options.childProperty;var b=i.options.nameProperty;var d=i.options.valueProperty;var g=[];var h=[];e(f);for(var c=g.length-1;c>=0;c--){var k=g[c];if(k.isLeaf||!i.options.leafOnly){h.push(k[d])}else{g.splice(c,1)}}h.reverse();l.data("selecteds",g);l.data("value",h);function e(r){if(r.tnSelected){var q=false;if(!r.isLeaf){for(var m=0;m<r[a].length;m++){var s=r[a][m];e(s);q=q||s.tnSelected}}if(!q){var o=r.parent;var n=i._copyItem(r);var j=r[b];while(o){if(o[b]){j=o[b]+"-"+j}o=o.parent}n.fullPath=j;g.push(n)}}}},getValues:function(){var a=this.element.data("value");if(this.options.multiple){return a}else{if(a[0]){return a[0]}else{return""}}},_updateDom:function(){var d=this;var c=$(d.element);var f=c.parent().find(">.panel-out-warp .panel-warp");var b=c.data("nodes");var a=d._getNameTxt();var g=c.next(".name-out-warp").find(".tree-names");if(a===undefined){g.html("<span class='selectTip'>"+d.options.selectTip+"</span>")}else{if(d.options.html){g.html(a)}else{g.text(a)}}var e=d._renderOption(b);f.find(".tree-ul").remove();f.append(e)},});$.widget("jsform.treeSelectDom",{options:{delIcon:false,change:function(){},selectclick:function(){},},_create:function(){var a=this.element;a.hide();this.createProxy()},createProxy:function(){var q=this.element;var l=this;var n=q.attr("id");n=n?(n+"_tree"):"";var m=q.attr("name")+"_tree";m=m?(m+"_tree"):"";var o=[];var r=q.children();var e=[];if(l.options.multiple){e=l.options.values||[]}else{var h=q.find("option:selected");h.each(function(j,s){if(!$(s).attr("remove")){e.push($(s).attr("value"))}})}for(var f=0;f<r.length;f++){if(r[f].tagName=="OPTGROUP"){var a=$(r[f]).children();var g=[];for(var d=0;d<a.length;d++){if($(a[d]).attr("remove")){continue}g.push({name:$(a[d]).text(),value:$(a[d]).attr("value"),enable:$(a[d]).attr("enable")||!$(a[d]).prop("disabled"),bgcolor:$(a[d]).attr("bgcolor")||"",})}o.push({name:$(r[f]).attr("label"),value:$(r[f]).attr("label"),items:g})}else{if($(r[f]).attr("remove")){continue}o.push({name:$(r[f]).text(),value:$(r[f]).attr("value"),enable:$(r[f]).attr("enable")||!$(r[f]).prop("disabled"),bgcolor:$(r[f]).attr("bgcolor")||"",})}}var b=q.next(".treeselect-warp");if(b.length){b.remove()}var k=$('<div class="treeselect-warp"><input type="hidden" name="'+m+'" id="'+n+'"></div>');k.css({width:l.options.width});q.after(k);$tree=k.find("input");this.$tree=$tree;var c=q.prop("disabled");l.options.treeData=o;l.options.value=e;l.options.disabled=c;l.options.treeChange=function(j,i){l._change(j,i)};$tree.treeSelect(l.options)},_change:function(d,b){var c=this;var a=c.element;a.val(b);if(c.options.multiple){a.data("values",b)}a.trigger("change");if($.type(c.options.change)==="function"){c._trigger("change")}},_bindEvent:function(){},getValues:function(){if(this.options.multiple){return this.element.data("values")}else{return this.element.val()}},setValues:function(a){if(!(a instanceof Array)){a=[a]}this.options.values=a;this.element.data("values",a);this.updateOpt()},updateOpt:function(){this.createProxy()}});$.widget("jsform.simpleColorPicker",{options:{colors:["rgba(255,255,255,0.3)","rgba(5,20,51,0.3)","rgba(46,115,255,0.3)","rgba(38,191,99,0.3)","rgba(255,76,76,0.3)","rgba(250,211,55,0.3)","rgba(54,203,203,0.3)","rgba(250,140,22,0.3)","rgba(151,95,228,0.3)",""],chooseColor:function(){},},_create:function(){var b=this.element;var d=this;if(b.find(".color-plan").length){b.find(".color-plan").remove()}var a=$("<ul class='simple-color-picker color-plan hide'></ul>");var c=this.options;c.colors.forEach(function(e){if(e){a.append('<li class="color-item" color="'+e+'" style="background-color: '+e+';" title="'+e+'"></li>')}else{a.append('<li class="color-item transparent" color="" title="透明"></li>')}});d.colorPlan=a;b.append(a);b.on("click",function(){var e=b.hasClass("open");if(e){d.close()}else{d.open()}}).on("click",".color-item",function(){d.options.chooseColor($(this).attr("color"),b)});$(document).on("click",function(g){var f=b;if(f.is($(g.target)||f.has($(g.target)))){return}else{d.close()}})},close:function(){var a=this.element;a.removeClass("open");this.colorPlan.addClass("hide")},open:function(){var a=this.element;a.addClass("open");this.colorPlan.removeClass("hide")}});$.widget("jsform.mutiselectedit",{options:{fldlbls:[],only:false},_create:function(){var a=this;var b=this.element;b.on("click",function(c){c.stopPropagation();a._createPanel()});a._initEvents()},_createPanel:function(){$(".mutiselectedit-panel").remove();var b=$('<div class="mutiselectedit-panel pretty-box"><div class="mutiselectedit-panel-wrap"></div></div>');var d=this.options;$.each(d.fldlbls,function(g,h){var f=$.getUUID(13,18);var e;if(h==="--------"){b.find(".mutiselectedit-panel-wrap").append('<div class="mutiselectedit-panel-item mutiselectedit-panel-item-split">--------</div>')}else{if(d.only){e=$('<div class="mutiselectedit-panel-item"><input type="radio" id="'+f+'" value="'+h+'"><label for="'+f+'">'+h+"</label></div>")}else{e=$('<div class="mutiselectedit-panel-item"><input type="checkbox" id="'+f+'" value="'+h+'"><label for="'+f+'">'+h+"</label></div>")}b.find(".mutiselectedit-panel-wrap").append(e)}});$("body").append(b);var a=this.element.outerWidth();b.width(a);b.position({of:this.element,my:"left top",at:"left bottom"});if(b.mCustomScrollbar){b.find(".mutiselectedit-panel-wrap").mCustomScrollbar()}this._initChecked();var c=this;b.on("click",'input[type="checkbox"]',function(e){e.stopPropagation();var f=[];b.find('input[type="checkbox"]').each(function(g,h){if($(h).prop("checked")){f.push($(h).val())}});c.element.val(f.join(";"))});b.on("click",'input[type="radio"]',function(e){e.stopPropagation();if($(this).prop("checked")){b.find('input[type="radio"').prop("checked",false);$(this).prop("checked",true);c.element.val($(this).val())}})},_isHasBind:function(f,e,d){var b=false;var a=$(f).data("events")[e];if(a){for(var c=0;c<a.length;c++){if(a[c].namespace===d){b=true;break}}}return b},_initEvents:function(){if(!this._isHasBind(document,"click","mutiselectedit")){$(document).on("click.mutiselectedit",function(a){if($(a.target).hasClass("mCSB_dragger")||$(a.target).hasClass("mCSB_dragger_bar")){return}if($(a.target).closest(".mutiselectedit-panel").length<=0){$(".mutiselectedit-panel").remove()}})}},_initChecked:function(){var b=this.options;var c=this.element.val();if(b.only){$(".mutiselectedit-panel").find('input[type="radio"]').each(function(e,d){if($(d).val()==c){$(d).prop("checked",true)}})}else{var a=c.split(";");$(".mutiselectedit-panel").find('input[type="checkbox"]').each(function(e,d){if($.inArray($(d).val(),a)>=0){$(d).prop("checked",true)}})}},_setOption:function(a,b){if(a=="only"){this.options.only=b}else{if(a=="fldlbls"){this.options.fldlbls=b}}this.element.val("")},_setOptions:function(a){this.options=$.extend(true,options,a);this.element.val("")},destroy:function(){this.element.off("click");this.options.only=false;this.options.fldlbls=[];$(".mutiselectedit-panel").remove();$.Widget.prototype.destroy.call(this)}});$.widget("jsform.smssign",{options:{userId:"",smshost:"",sign:"",width:"250px",lineHeight:"30px"},getDefaultSign:function(){var a="";$.each(this.element.find("option"),function(c,b){var d=$(b).val();if(!a&&d&&d!="applysign"){a=d}});return a},selectSign:function(a){var b=false;$.each(this.element.find("option"),function(d,c){var e=$(c).val();if(e==a){$(c).prop("selected",true);b=true;return false}});if(!b){this.element.append('<option value="'+a+'" disabled="disabled">'+a+"</option>")}this.element.val(a);this.element.treeSelectDom("updateOpt")},_create:function(){var b=this.element;var a=this.options;$.postJSON(a.smshost+"/web/sms/getsmssign",{userId:a.userId},function(c){if(c.error=="0"){var d=false;if(!a.sign){d=true}if(c.data&&c.data.length>0){$.each(c.data,function(f,g){if(a.sign&&a.sign==g.sign){d=true}var e="";if(g.checkcode=="SUCCESS"){e='<option value="'+g.sign+'">'+g.sign+"</option>"}else{if(g.checkcode=="CHECKING"){e='<option value="'+g.sign+'">'+g.sign+"(审核中)</option>"}else{if(g.checkcode=="FAIL"){e='<option value="'+g.sign+'" disabled="disabled">'+g.sign+"(未通过)</option>"}}}b.append(e)})}if(!d){b.append('<option value="'+a.sign+'" disabled="disabled">'+a.sign+"</option>")}}else{console.error(c.message)}},{async:false});b.append('<option disabled="disabled">---------</option><option value="applysign">申请新的签名</option>');b.treeSelectDom({width:a.width,lineHeight:a.lineHeight})}});$.widget("jsform.smsremain",{options:{userId:"",smshost:""},_create:function(){var e=this.element;var c=this.options;var a='<span class="zsmsremain" style="color:#545454;">目前账户可用短信量<span id="zsmsremain" class="smsnumber" style="color: #5b99fd"> {0} </span>条。<a target="_blank" href="{1}" style="color: #61d790;">购买</a></span>';var d="0";var b=c.smshost+"/app/sms/accounts";$.postJSON(c.smshost+"/web/sms/account",{userId:c.userId}).done(function(f){if(f.error=="0"){d=f.data.size-f.data.used}e.html($.format(a,d,b))}).fail(function(){e.html($.format(a,d,b))})}});$.widget("jsform.paginations",{options:{totalpage:0,displayedPages:3,edges:1,currentPage:0,selectPage:$.noop()},_init:function(){var a=this;a._draw();a.element.on("click","a",function(){var c=$(this).closest("li");if(c.hasClass("disabled")||c.hasClass("active")){return}var b=0;if($(this).hasClass("prebtn")){b=a.options.currentPage}else{if($(this).hasClass("nextbtn")){b=a.options.currentPage+2}else{b=parseInt($(this).text())}}a.options.selectPage(b)})},_draw:function(){this.element.off("click");this.element.empty();var f=this.options;if(f.currentPage>=1){f.currentPage=f.currentPage-1}var h=$('<ul class="jspaginations"></ul>').appendTo(this.element);this._appendItem(f.currentPage-1,{text:"<i class='iconfont'>&#xe72a;</i>",classes:"prebtn"});var c=this._getInterval();if(c.start>0&&f.edges>0){var a=Math.min(f.edges,c.start);for(var e=0;e<a;e++){this._appendItem(e)}if(f.edges<c.start&&(c.start-f.edges!=1)){h.append('<li class="disabled"><a class="ellipse" href="javascript:;">...</span></li>')}else{if(c.start-f.edges==1){this._appendItem(f.edges)}}}for(var d=c.start;d<c.end;d++){this._appendItem(d)}if(c.end<f.totalpage&&f.edges>0){if(f.totalpage-f.edges>c.end&&(f.totalpage-f.edges-c.end!=1)){h.append('<li class="disabled"><a href="javascript:;" class="ellipse">...</a></li>')}else{if(f.totalpage-f.edges-c.end==1){this._appendItem(c.end)}}var g=Math.max(f.totalpage-f.edges,c.end);for(var b=g;b<f.totalpage;b++){this._appendItem(b)}}this._appendItem(f.totalpage+1,{text:"<i class='iconfont'>&#xe68d;</i>",classes:"nextbtn"})},_setOptions:function(a){$.extend(true,this.options,a)},_halfDisplayed:0,_getInterval:function(){this._halfDisplayed=this.options.displayedPages/2;var a=this.options;return{start:Math.ceil(a.currentPage>this._halfDisplayed?Math.max(Math.min(a.currentPage-this._halfDisplayed,(a.totalpage-a.displayedPages)),0):0),end:Math.ceil(a.currentPage>this._halfDisplayed?Math.min(a.currentPage+this._halfDisplayed,a.totalpage):Math.min(a.displayedPages,a.totalpage))}},_appendItem:function(a,h){var g;var c=this.element.find("ul.jspaginations");var b=$("<li></li>");var d=this.options;var f={text:a+1,classes:"pagebtn"};var e=$.extend(f,h||{});var a=a<0?0:(a<d.totalpage?a:d.totalpage-1);if(a==d.currentPage){if(f.classes==="prebtn"||f.classes==="nextbtn"){b.addClass("disabled")}else{b.addClass("active")}g=$('<a href="javascript:;" class="current">'+(f.text)+"</a>")}else{g=$('<a href="javascript:;">'+(f.text)+"</a>")}g.addClass(e.classes);b.append(g);c.append(b)}});(function(a){a.fn.extend({insertContent:function(i,j){var g=a(this)[0];if(document.selection){this.focus();var d=document.selection.createRange();d.text=i;this.focus();d.moveStart("character",-e);var f=d.text.length;if(arguments.length==2){var e=g.value.length;d.moveEnd("character",f+j);j<=0?d.moveStart("character",f-2*j-i.length):d.moveStart("character",f-j-i.length);d.select()}}else{if(g.selectionStart||g.selectionStart=="0"){var h=g.selectionStart;var b=g.selectionEnd;var c=g.scrollTop;g.value=g.value.substring(0,h)+i+g.value.substring(b,g.value.length);this.focus();g.selectionStart=h+i.length;g.selectionEnd=h+i.length;g.scrollTop=c;if(arguments.length==2){g.setSelectionRange(h-j,g.selectionEnd+j);this.focus()}}else{this.value+=i;this.focus()}}},autoDisplayRel:function(){var b=a(this);b.each(function(){var e=a(this),d=a(e.attr("rel")),f=e.attr("relbg"),c=e.attr("clear")||"1";e.bind({click:function(){d.find("input").clearErrorFlag();if(a(this).prop("checked")){if(e.is(":radio")){a(":radio[name='"+e.attr("name")+"']").each(function(g,h){if(a(h).attr("rel")){a(a(h).attr("rel")).addClass("hide")}})}d.removeClass("hide");if(f){a(f).removeClass("bgwhite bggray").addClass("bggray")}}else{if(c!="0"){d.setValues({},true)}d.addClass("hide");if(f){a(f).removeClass("bgwhite bggray").addClass("bgwhite")}}}})})},ztabs:function(){function b(){var c=a(this);c.find(".ztab-indexs").on("click",".ztab-item",function(){var f=a(this);var e=f.index();if(f.hasClass("active")){return false}else{f.siblings(".ztab-item").removeClass("active");f.addClass("active");var d=c.find(".ztab-item-content");d.removeClass("active");d.eq(e).addClass("active")}})}this.each(function(){a.proxy(b,this)()})}})})(jQuery);$.widget("jsform.tabWarp",{options:{index:0},_create:function(){var c=this.element;var b=this.options;if(b.index.toLowerCase()==="first"){b.index=0}if(b.index.toLowerCase()==="last"){b.index=Infinity}var a=c.find("#toggle-tab-box").find("a").length-1;if(b.index<0){b.index=0}if(b.index>a){b.index=a-1}var d=c.find("#toggle-tab-box").find(".tap").eq(b.index);d.addClass("choose").siblings().removeClass("choose");$('.tab-box[index="'+d.attr("index")+'"]').show().siblings(".tab-box").hide();c.find("#toggle-tab-box").on("click",".tap",function(){$(this).addClass("choose").siblings().removeClass("choose");var e=$(this).attr("index");$('.tab-box[index="'+e+'"]').show().siblings(".tab-box").hide()})}});$.widget("jsform.entrydata",{options:{IMAGEURL:"https://jsformfiles.biaodan.info/",FILEIMAGEVIEWSTYLE:"",FILEURL:"https://jsformfiles.biaodan.info/",FILEIMGURL:"https://jsformimages.biaodan.info/"},_create:function(){var a=this;if($("#outerdiv").length==0){$("body").eq(0).append('<div id="outerdiv" style="position:fixed;top:0;left:0;background:rgba(0,0,0,1);z-index:2;width:100%;height:100%;display:none;"><div id="innerdiv" style="position:absolute;"><img id="bigimg" style="border:5px solid #fff;" src="" /></div></div>')}$(this.element).on("click","span.big-img",function(){var b=$(this).attr("url");a._imgShow("#outerdiv","#innerdiv","#bigimg",b)})},_imgShow:function(d,c,a,b){$(a).attr("src",b);$("<img/>").attr("src",b).load(function(){var e=$(window).width();var j=$(window).height();var m=this.width;var i=this.height;var k,l;var f=0.8;if(i>j*f){l=j*f;k=l/i*m;if(k>e*f){k=e*f}}else{if(m>e*f){k=e*f;l=k/m*i}else{k=m;l=i}}$(a).css("width",k);var n=(e-k)/2;var g=(j-l)/2;$(c).css({top:g,left:n});$(d).fadeIn("fast")});$(d).click(function(){$(this).fadeOut("fast")})},_destroy:function(){this.element.off()},_getItemBgcolor:function(d,b){var a="";if(d.ITMS&&d.ITMS.length){for(var c=0;c<d.ITMS.length;c++){var e=d.ITMS[c];if(e.VAL==b){a=e.COLOR||"";break}}}return a},_fillFixLblTableData:function(d,b){var a=d.FIXEDLBLS||[];if(!a.length||!b){return b}var c=b.filter(function(e){return a.indexOf(e.FIXLBL)>=0});$.each(a,function(g,e){var h=false;for(var f=0;f<c.length;f++){if(e==c[f].FIXLBL){h=true;break}}if(!h){c.push({FIXLBL:e})}});c.sort(function(f,e){var h=a.indexOf(f.FIXLBL);var g=a.indexOf(e.FIXLBL);return h-g});return c},_createSubField:function(u,q){var o=this.options.FILEURL;var i="";if(q.TYP==="url"){if(u[q.NM]){i=$.format("<a class='underline' title='打开此页面' href='{0}' target='_blank'>{1}</a>",u[q.NM],u[q.NM])}else{i="&nbsp;"}}else{if(q.TYP==="date"){if(u[q.NM]){i=u[q.NM];if(q.DFMT&&q.DFMT!=="ymd"){var b=i.split("-");if(q.DFMT==="mdy"){i=$.format("{0}/{1}/{2}",b[1],b[2],b[0])}else{if(q.DFMT==="dmy"){i=$.format("{0}/{1}/{2}",b[2],b[1],b[0])}else{if(q.DFMT==="ymdc"){i=$.format("{0}年{1}月{2}日",b[0],b[1],b[2])}}}}}else{i="&nbsp;"}}else{if(q.TYP==="money"){if(u[q.NM]){i=currencys[q.FMT]+u[q.NM]}else{i="&nbsp;"}}else{if(q.TYP==="map"){var c=u[q.SUBFLDS.TXT.NM]||"",m=u[q.SUBFLDS.J.NM],h=u[q.SUBFLDS.W.NM];i=$.tmpl("<a class='underline location' title='在高德地图中查看' href='${mapUrl}' target='_blank'>${location}</a>",{mapUrl:$.format(mapUrlPoint,h,m),location:c});if(m&&h){}else{i=c}}else{if(q.TYP==="address"){var r=u[q.SUBFLDS.ZIP.NM]?u[q.SUBFLDS.ZIP.NM]:" ",d=u[q.SUBFLDS.PRV.NM]?u[q.SUBFLDS.PRV.NM]:" ",n=u[q.SUBFLDS.CITY.NM]?u[q.SUBFLDS.CITY.NM]:" ",s=u[q.SUBFLDS.DTL.NM]?u[q.SUBFLDS.DTL.NM]:" ";if(r||d||n||s){i=$.tmpl("<div class='location'><a class='underline' title='在高德地图中查看' href='${mapUrl}' target='_blank'>${province},${city},${zip}<span>${detail}</span></a></div>",{mapUrl:$.format(mapUrlTxt,d+" "+n+" "+r+" "+s),zip:r,province:d,city:n,detail:s})}else{i="&nbsp;"}}else{if(q.TYP==="checkbox"){$(q.ITMS).each(function(v,w){if(u[w.NM]){var f="";if(u[w.NM]==w.VAL&&w.COLOR){f=w.COLOR}if(f){i=i+"<span class='item-text' style='background-color: "+f+";color:#ffffff;'>"+u[w.NM]+"</span><br/>"}else{i=i+"<span class='simple-data' >"+u[w.NM]+"</span><br/>"}}})}else{if(q.TYP==="file"){if(u[q.SUBFLDS.ID.NM]!=null){var t=u[q.SUBFLDS.ID.NM];var e=(u[q.SUBFLDS.TYP.NM]).split(",");var g=(u[q.SUBFLDS.NM.NM]).split(",");var l="";var k=(u[q.SUBFLDS.ID.NM+"_tokens"]).split(",");$.each(t.split(","),function(j,f){if($.isImage(e[j])){l=$.format("<img src='{0}{1}?{2}' class='img'/><p></p></br>",o,f+e[j],k[j]);i+=$.format("<a class='underline' target='_blank' href='{0}{1}?{2}'>{3}</a>",o,f+(e[j]==".nosuffix"?"":e[j]),k[j],l)}else{if($.isOfficeFile(e[j])){l=$.format("<div >{0}</div></br>",g[j]);i+=$.format("<a class='underline' target='_blank' href='{0}'>{1}</a>","https://view.officeapps.live.com/op/view.aspx?src="+encodeURIComponent(o+f+e[j]+"?"+k[j]),l)}else{l=$.format("<div >{0}</div></br>",g[j]);i+=$.format("<a class='underline' target='_blank' href='{0}{1}?{2}'>{3}</a>",o,f+(e[j]==".nosuffix"?"":e[j]),k[j],l)}}$("a.freeze").hide()})}else{i="&nbsp;"}}else{if(q.TYP==="radio"||q.TYP==="dropdown"){if(u[q.NM]){var a=this._getItemBgcolor(q,u[q.NM]);if(a){i="<span class='item-text' style='background-color: "+a+";color: #ffffff;'>"+u[q.NM]+"</span>"}else{i="<span class='simple-data' >"+u[q.NM]+"</span>"}}else{i="&nbsp;"}}else{if(u[q.NM]||u[q.NM]===0){i=u[q.NM];if(q.DIGITS&&$.type(u[q.NM])==="number"){i=u[q.NM].toFixed(parseInt(q.DIGITS))}}else{i="&nbsp;"}}}}}}}}}i="<td>"+i+"</td>";return i},_createMobileFiels:function(f,e,c){var a=this.options.FILEURL;var d=this;var b="<div class='subdata-header'>";var g=f.FIXLBL?f.FIXLBL:"第"+c+"行";b+="<span class='header-name'>"+g+"</span><span class='opera'><i class='iconfont toogle-ico'></i><span class='toogle-text'>展开</span></span>";b+="</div>";$.each(e,function(m,k){var n="";if(k.TYP==="checkbox"){$(k.ITMS).each(function(t,u){if(f[u.NM]){var s="";if(f[u.NM]==u.VAL&&u.COLOR){s=u.COLOR}if(s){n=n+"<span class='item-text' style='background-color: "+s+";color:#ffffff;'>"+f[u.NM]+"</span><br/>"}else{n=n+"<span class='simple-data' >"+f[u.NM]+"</span><br/>"}}})}else{if(k.TYP==="date"){if(f[k.NM]){n=f[k.NM];if(k.DFMT&&k.DFMT!=="ymd"){var q=n.split("-");if(k.DFMT==="mdy"){n=$.format("{0}/{1}/{2}",q[1],q[2],q[0])}else{if(k.DFMT==="dmy"){n=$.format("{0}/{1}/{2}",q[2],q[1],q[0])}else{if(k.DFMT==="ymdc"){n=$.format("{0}年{1}月{2}日",q[0],q[1],q[2])}}}}}}else{if(k.TYP==="file"){if(f[k.SUBFLDS.ID.NM]!=null){var o=f[k.SUBFLDS.ID.NM];var h=(f[k.SUBFLDS.TYP.NM]).split(",");var i=(f[k.SUBFLDS.NM.NM]).split(",");var j="";var l=(f[k.SUBFLDS.ID.NM+"_tokens"]).split(",");$.each(o.split(","),function(t,s){if($.isImage(h[t])){j=$.format("<img src='{0}{1}?{2}' class='img'/><p></p></br>",a,s+h[t],l[t]);n+=$.format("<a class='underline' target='_blank' href='{0}{1}?{2}'>{3}</a>",a,s+(h[t]==".nosuffix"?"":h[t]),l[t],j)}else{if($.isOfficeFile(h[t])){j=$.format("<div >{0}</div></br>",i[t]);n+=$.format("<a class='underline' target='_blank' href='{0}'>{1}</a>","https://view.officeapps.live.com/op/view.aspx?src="+encodeURIComponent(a+s+h[t]+"?"+l[t]),j)}else{j=$.format("<div >{0}</div></br>",i[t]);n+=$.format("<a class='underline' target='_blank' href='{0}{1}?{2}'>{3}</a>",a,s+(h[t]==".nosuffix"?"":h[t]),l[t],j)}}$("a.freeze").hide()})}else{n="&nbsp;"}}else{if(k.TYP==="radio"||k.TYP==="dropdown"){if(f[k.NM]){var r=d._getItemBgcolor(k,f[k.NM]);if(r){n="<span class='item-text' style='background-color: "+r+";color: #ffffff;'>"+f[k.NM]+"</span>"}else{n="<span class='simple-data' >"+f[k.NM]+"</span>"}}else{n="&nbsp;"}}else{if(f[k.NM]||f[k.NM]===0){n=f[k.NM];if(k.DIGITS&&$.type(f[k.NM])==="number"){n=f[k.NM].toFixed(parseInt(k.DIGITS))}}else{n="&nbsp;"}}}}}b+="<div class='subdata-row'><div class='subfld-title'>"+k.LBL+"</div><div class='subfld-content'>"+n+"</div></div>"});return b},view:function(j){var a=this.options;var e=a.IMAGEURL;var m=a.FILEIMAGEVIEWSTYLE;var u=a.FILEURL;var w=a.FILEIMGURL;var b=j.form;var x=j.data;var o=j.showAllFld;var i=j.showFields||[];var q=b.HDEMP;var l=this.element;var c=j.links||{};var s=j.desentive||{};var d=j.isPubQuery;var f=j.isMobile;var t=this;var n=false;var g={star:"&#xe700;",heart:"&#xe6a7;",like:"&#xe7dd;",flower:"&#xe7df;",fire:"&#xe7e6;",shit:"&#xe7e4;"};var h={sum:"求和",max:"最大值",min:"最小值",average:"平均数",middle:"中位数"};$(b.FLDS).each(function(ai,aj){if(aj.TYP==="goods"){n=true}if(o!=="1"&&$.inArray(aj.FLDID,i)<0){if(aj.TYP=="likert"){$.each(aj.ITMS,function(v,ar){l.find("#td"+ar.NM).parent().remove()})}else{l.find("#td"+aj.FLDID).parent().remove()}return true}var L=x[aj.NM];if(L&&s[aj.NM]=="1"){var K=L.length;if(K<=7){L="****"}else{L=L.substr(0,3)+"****"+L.substr(L.length-4,L.length)}}var C;if(c[aj.NM]){var C=c[aj.NM];if(C.indexOf("?")>0){var J=C.split("?");C=J[0];var am=J[1].split("&");for(var an=0;an<am.length;an++){var B=am[an];if(!B.trim()){continue}var ad=B.split("=")[0]||"";var aq=B.split("=")[1]||"";if(an==0){C+=("?"+ad+"="+aq.replace("field","F"))}else{C+=("&"+ad+"="+aq.replace("field","F"))}}}C=$.tmpl(C,x).text();if(!/^(http(s)?:)?\/\//.test(C)){C="http://"+C}}var aa="";if(aj.TYP==="file"){if(x[aj.SUBFLDS.ID.NM]!=null){var A=(x[aj.SUBFLDS.ID.NM]).split(",");var V=(x[aj.SUBFLDS.TYP.NM]).split(",");var ab=(x[aj.SUBFLDS.NM.NM]).split(",");var D="";var U=(x[aj.SUBFLDS.ID.NM+"_tokens"]).split(",");var E=(x[aj.SUBFLDS.ID.NM+"_styletokens"]).split(",");$.each(A,function(ar,v){if($.isImage(V[ar])){D=$.format("<img src='{0}{1}?{2}' class='img'/></br>",e,v+V[ar],E[ar]);aa+=$.format("<span class='underline big-img' url='{0}{1}?{2}'>{3}</span>",u,v+(V[ar]==".nosuffix"?"":V[ar]),U[ar],D)}else{if($.isOfficeFile(V[ar])){D=$.format("<div >{0}</div></br>",ab[ar]);aa+=$.format("<a class='underline' target='_blank' href='{0}'>{1}</a>","https://view.officeapps.live.com/op/view.aspx?src="+encodeURIComponent(u+v+V[ar]+"?"+U[ar]),D)}else{if(/\.pdf$/.test(V[ar])){D=$.format("<div >{0}</div></br>",ab[ar]);if($.isWebapp()){aa+=$.format("<a class='underline' target='_blank' href='{0}'>{1}</a>","/pdf_viewer.html?file="+encodeURIComponent("https://jsformfiles.biaodan.info/"+v+V[ar]+"?"+U[ar]),D)}else{aa+=$.format("<a class='underline' target='_blank' href='{0}{1}?{2}'>{3}</a>",u,v+V[ar],U[ar],D)}}else{D=$.format("<div >{0}</div></br>",ab[ar]);aa+=$.format("<a class='underline' target='_blank' href='{0}{1}?{2}'>{3}</a>",u,v+(V[ar]==".nosuffix"?"":V[ar]),U[ar],D)}}}});l.find("#td"+aj.FLDID).html(aa)}else{l.find("#td"+aj.FLDID).html("")}}else{if(aj.TYP==="url"){if(x[aj.NM]){aa=$.format("<a class='underline' title='打开此页面' href='{0}' target='_blank'>{1}</a>",x[aj.NM],x[aj.NM]);l.find("#td"+aj.FLDID).html(aa)}else{l.find("#td"+aj.FLDID).html("")}}else{if(aj.TYP==="date"){if(x[aj.NM]){aa=x[aj.NM];if(aj.DFMT&&aj.DFMT!=="ymd"){var P=aa.split("-");if(aj.DFMT==="mdy"){aa=$.format("{0}/{1}/{2}",P[1],P[2],P[0])}else{if(aj.DFMT==="dmy"){aa=$.format("{0}/{1}/{2}",P[2],P[1],P[0])}else{if(aj.DFMT==="ymdc"){aa=$.format("{0}年{1}月{2}日",P[0],P[1],P[2])}}}}l.find("#td"+aj.FLDID).html(aa)}else{l.find("#td"+aj.FLDID).html("")}}else{if(aj.TYP==="map"){var H=x[aj.SUBFLDS.TXT.NM]||"",ah=x[aj.SUBFLDS.J.NM],Z=x[aj.SUBFLDS.W.NM];aa=$.tmpl("<a class='underline location' title='在高德地图中查看' href='${mapUrl}' target='_blank'>${location}</a>",{mapUrl:$.format(mapUrlPoint,Z,ah),location:H});if(ah&&Z&&H){l.find("#td"+aj.FLDID).html(aa)}else{l.find("#td"+aj.FLDID).html(H)}}else{if(aj.TYP==="address"){var N=x[aj.SUBFLDS.ZIP.NM]?x[aj.SUBFLDS.ZIP.NM]:"",z=x[aj.SUBFLDS.PRV.NM]?x[aj.SUBFLDS.PRV.NM]:"",I=x[aj.SUBFLDS.CITY.NM]?x[aj.SUBFLDS.CITY.NM]:"",ao=x[aj.SUBFLDS.DTL.NM]?x[aj.SUBFLDS.DTL.NM]:"";if(N||z||I||ao){var ac=[];if(z){ac.push(z)}if(I){ac.push(I)}if(N){ac.push(N)}if(ao){ac.push(ao)}var ak=ac.join(",");aa=$.tmpl("<div class='location'><a class='underline' title='在高德地图中查看' href='${mapUrl}' target='_blank'>${arrdressStr}</a></div>",{mapUrl:$.format(mapUrlTxt,z+" "+I+" "+N+" "+ao,z||""),arrdressStr:ak});l.find("#td"+aj.FLDID).empty().append(aa)}else{l.find("#td"+aj.FLDID).html("")}}else{if(aj.TYP==="dropdown2"){aa="";var F=2;if(aj.pN){F=parseInt(aj.pN)}for(var ae=1;ae<=F;ae++){var W=x[aj.SUBFLDS["DD"+ae].NM]?x[aj.SUBFLDS["DD"+ae].NM]:"";if(W){aa=aa+W+","}}if(aa){aa=aa.substring(0,aa.length-1);l.find("#td"+aj.FLDID).empty().append(aa)}else{l.find("#td"+aj.FLDID).html("")}}else{if(aj.TYP==="name"){if(x[aj.NM]){if($.isImage(x[aj.NM])){var G=x[aj.NM+"_tokens"]||"";var Q='<a href="'+u+x[aj.NM]+"?"+G+'" target="_blank"><img src="'+u+x[aj.NM]+"?"+G+'" class="" style="max-width: 100%"></a>';l.find("#td"+aj.FLDID).html(Q)}else{if(C){aa=$.format("<a class='underline link' href='{0}' target='_blank'>{1}</a>",C,L);l.find("#td"+aj.FLDID).html(aa)}else{l.find("#td"+aj.FLDID).text(L)}}}else{l.find("#td"+aj.FLDID).html("")}}else{if(aj.TYP==="checkbox"){$(aj.ITMS).each(function(ar,at){if(x[at.NM]){var v="";if(x[at.NM]==at.VAL&&at.COLOR){v=at.COLOR}if(v){aa=aa+"<span class='item-text' style='background-color: "+v+";color: #ffffff;'>"+x[at.NM]+"</span><br/>"}else{aa=aa+"<span class='simple-data'>"+x[at.NM]+"</span><br/>"}}});l.find("#td"+aj.FLDID).html(aa||"")}else{if(aj.TYP==="goods"){n=true;$(aj.ITMS).each(function(au,ay){if(x[ay.NM]){var az=ay.VAL;var at=ay.PRC||0;if(ay.GGXH){var v=ay.GGXH;var aw=v.LVL;var ax={};var av;for(var ar=1;ar<=aw;ar++){if(x[v["DD"+ar].NM]){az=az+"("+x[v["DD"+ar].NM]+")";ax["DD"+ar]=x[v["DD"+ar].NM]}}$.each(v.DTL,function(aB,aC){var aA=true;for(p in ax){if(ax[p]!=aC[p]){aA=false;break}}if(aA){av=aC;return false}});if(av&&av.PRC){at=av.PRC}}aa=aa+$.format("{0}：{1}{2} × {3}({4})<br/>",az,!ay.CNY?"¥":ay.CNY,at,x[ay.NM],ay.UNT||"")}});l.find("#td"+aj.FLDID).html(aa||"")}else{if(aj.TYP==="likert"){$(aj.ITMS).each(function(v,ar){if(x[ar.NM]){l.find("#td"+ar.NM).text(x[ar.NM])}else{l.find("#td"+ar.NM).text("")}})}else{if(aj.TYP=="phone"){if(x[aj.NM]){var Y=new RegExp("-$");if(C){aa=$.format("<a class='underline link' href='{0}' target='_blank'>{1}</a>",C,L)}else{aa=$.format("<a class='underline' title='拨打电话' href='tel:{0}' target='_blank'>{1}</a>",Y.test(x[aj.NM])?x[aj.NM].substring(0,x[aj.NM].length-1):x[aj.NM],L)}l.find("#td"+aj.FLDID).html(aa)}else{l.find("#td"+aj.FLDID).html("")}}else{if(aj.TYP==="table"){var M=aj.SUBFLDS;var y=x[aj.NM];y=t._fillFixLblTableData(aj,y);x[aj.NM]=y;if(!f){if(y&&y.length>0){var X=false;var O=210*M.length;aa="<table class='subtable' border='1' bordercolor='#ddd' style='width: "+O+"px;'><tr>";if(y[0].FIXLBL){aa+=("<th>&nbsp;</th>")}$.each(M,function(v,ar){aa+="<th>"+ar.LBL+"</th>";if(ar.SUMMARY){X=true}});aa+="</tr>";$.each(y,function(v,ar){aa+="<tr>";if(ar.FIXLBL){aa+=("<td>"+ar.FIXLBL+"</td>")}$.each(M,function(at,au){aa+=t._createSubField(ar,au)});aa+="</tr>"});if(X){aa+="<tfoot>";if(y[0].FIXLBL){aa+="<td>汇总</td>"}$.each(M,function(at,au){if(au.SUMMARY){var v=[];y.forEach(function(av){v.push(av[au.NM]||"")});var ar=$.summary_calc(au.SUMMARY,v);if(au.DIGITS&&ar){ar=ar.toFixed(parseInt(au.DIGITS))}aa+="<td>"+h[au.SUMMARY]+":"+ar+"</td>"}else{aa+="<td></td>"}});aa+="</tfoot>"}aa+="<table/>";l.find("#td"+aj.FLDID).html(aa||"&nbsp;").addClass("table-td")}else{l.find("#td"+aj.FLDID).html("&nbsp;")}l.find("#td"+aj.FLDID).css({"overflow-x":"scroll"})}else{if(y&&y.length>0){var X=false;$.each(M,function(v,ar){if(ar.SUMMARY){X=true}});y.forEach(function(ar,v){aa+="<div class='sub-table-data-warp row-close'>";aa+=t._createMobileFiels(ar,M,v+1);aa+="</div>"});if(X){aa+="<div class='sub-table-data-warp row-close'><div class='subdata-header'><span class='header-name'>汇总</span><span class='opera'><i class='iconfont toogle-ico'></i><span class='toogle-text'>展开</span></span></div>";$.each(M,function(at,au){if(au.SUMMARY){var v=[];y.forEach(function(av){v.push(av[au.NM]||"")});var ar=$.summary_calc(au.SUMMARY,v);if(au.DIGITS&&ar){ar=ar.toFixed(parseInt(au.DIGITS))}aa+="<div class='subdata-row'><div class='subfld-title'>"+aj.LBL+"-"+h[au.SUMMARY]+"</div><div class='subfld-content'>"+ar+"</div></div>"}});aa+="</div>"}l.find("#td"+aj.FLDID).html(aa||"&nbsp;").addClass("table-td");l.find("#td"+aj.FLDID).closest(".table-tr").addClass("table-close");var ag=l.find("#td"+aj.FLDID).closest(".table-tr").find("th");ag.html("<div class='table-fld-warp row-close'><span class='table-lbl'>"+ag.text()+"</span><span class='opera'><i class='iconfont toogle-ico'></i><span class='toogle-text'>展开</span></span></div>")}else{l.find("#td"+aj.FLDID).html("&nbsp;")}}}else{if(aj.TYP==="grade"){if(x[aj.NM]){var T=aj.STY||"star";var S="<span class='grade-star'>";if("number"===T){S+='<span class="grad-item number">'+x[aj.NM]+"</span>"}else{var R='<span class="grad-item '+T+'"><i class="iconfont">'+g[T]+"</i></span>";for(var ai=0;ai<x[aj.NM];ai++){S+=R}}S+="</span>";l.find("#td"+aj.FLDID).html(S)}else{l.find("#td"+aj.FLDID).text("")}}else{if(aj.TYP==="number"){if(typeof x[aj.NM]==="number"){var af=x[aj.NM];if(aj.DIGITS){af=af.toFixed(parseInt(aj.DIGITS))}l.find("#td"+aj.FLDID).text(af)}else{l.find("#td"+aj.FLDID).text("")}}else{if(aj.TYP==="dropdown"||aj.TYP==="radio"){if(x[aj.NM]){var al=t._getItemBgcolor(aj,x[aj.NM]);if(al){var ap="<span class='item-text' style='background-color: "+al+";color: #ffffff;'>"+x[aj.NM]+"</span>"}else{var ap="<span class='simple-data' >"+x[aj.NM]+"</span>"}}else{var ap="&nbsp;"}l.find("#td"+aj.FLDID).html(ap)}else{if(aj.TYP==="users"||aj.TYP==="groups"){if(x[aj.NM]){L="";x[aj.NM+"_objs"].forEach(function(ar){var v=ar.name||"";if(!L){L=v}else{L+=(";"+v)}});l.find("#td"+aj.FLDID).textWidthBr(L)}else{l.find("#td"+aj.FLDID).text("")}}else{if(x[aj.NM]&&C){l.find("#td"+aj.FLDID).html($.format("<a class='underline link' href='{0}' target='_blank'>{1}</a>",C,L))}else{if(x[aj.NM]&&/^http(s?):\/\/[0-9a-zA-Z]([\-\.\\w]*[0-9a-zA-Z])*(\/?)([a-zA-Z0-9\-\.\?\,:'\/\\\+=&amp;%\$#_]*)?$/.test(x[aj.NM])){l.find("#td"+aj.FLDID).html($.format("<a class='underline link' href='{0}' target='_blank'>{1}</a>",x[aj.NM],L))}else{if(x[aj.NM]||x[aj.NM]=="0"){l.find("#td"+aj.FLDID).textWidthBr(L)}else{l.find("#td"+aj.FLDID).text("")}}}}}}}}}}}}}}}}}}}});if(b.VERIFY=="1"&&(o=="1"||$.inArray("VERIFYSTATUS",i)>=0)){var r="";if(x.VERIFYSTATUS=="1"){r="已核销";if(x.VERIFYDATE){r+="("+x.VERIFYDATE+")"}}else{if(x.VERIFYSTATUS=="2"){r="部分核销";if(x.VERIFYDATE){r+="("+x.VERIFYDATE+")"}}else{r="未核销"}}l.find("#viewtable tr.verifystatus").remove();if(window.isMobile){if(x.VERIFYID){var k=$.format("<a href='/web/sv/{0}?formid={1}' target='_blank' class='code'><span class='spanText qrcode2-box'><img class='grid-img' src='/qrcode.jpg?type=verify&verifyid={0}'><span class='qrcode2-num'>{0}</span></span></a>",x.VERIFYID,b._id);l.find("#viewtable > tbody").append($.format('<tr class="verifystatus {0}"><th>核销码</th><td>{1}</td></tr>',$("#viewtable tr:last").hasClass("alt")?"":"alt",k))}}else{l.find("#viewtable > tbody").append($.format('<tr class="verifystatus {0}"><th>核销码</th><td>{1}</td></tr>',$("#viewtable tr:last").hasClass("alt")?"":"alt",x.VERIFYID?x.VERIFYID:""))}l.find("#viewtable > tbody").append($.format('<tr class="verifystatus {0}"><th>核销状态</th><td>{1}</td></tr>',$("#viewtable tr:last").hasClass("alt")?"":"alt",r));l.find("#viewtable > tbody").append($.format('<tr class="verifystatus {0}"><th>核销过期日期</th><td>{1}</td></tr>',$("#viewtable tr:last").hasClass("alt")?"":"alt",x.VERIFYEXPDATE?x.VERIFYEXPDATE:""));l.find("#viewtable > tbody").append($.format('<tr class="verifystatus {0}"><th>核销人</th><td>{1}</td></tr>',$("#viewtable tr:last").hasClass("alt")?"":"alt",x.VERIFYBY?x.VERIFYBY:""))}if(n){if((o=="1"||$.inArray("COUPON",i)>=0)&&b.COUPON=="1"){l.find("#viewtable tr.couponcode").remove();l.find("#viewtable > tbody").append($.format('<tr class="couponcode {0}"><th>优惠码</th><td>{1}</td></tr>',l.find("#viewtable tr:last").hasClass("alt")?"":"alt",x.COUPONCODE||""))}if(o=="1"||$.inArray("AMT",i)>=0){l.find("#viewtable tr.amount").remove();l.find("#viewtable > tbody").append($.format('<tr class="amount {0}"><th>金额</th><td>{1}</td></tr>',l.find("#viewtable tr:last").hasClass("alt")?"":"alt",x.AMT||0))}if(o=="1"||$.inArray("PAYSTATUS",i)>=0){l.find("#viewtable tr.paystatus").remove();if(x.PAYSTATUS=="已支付"||x.PAYSTATUS=="已退款"||x.PAYSTATUS=="部分退款"){if($.inArray("TRADEID",i)>=0){l.find("#viewtable > tbody").append($.format('<tr class="paystatus {0}"><th>在线支付状态</th><td>{1}（交易流水号:{2}）</td></tr>',$("#viewtable tr:last").hasClass("alt")?"":"alt",x.PAYSTATUS,x.TRADEID||""))}else{l.find("#viewtable > tbody").append($.format('<tr class="paystatus {0}"><th>在线支付状态</th><td>{1}</td></tr>',$("#viewtable tr:last").hasClass("alt")?"":"alt",x.PAYSTATUS))}}else{l.find("#viewtable > tbody").append($.format('<tr class="paystatus {0}"><th>在线支付状态</th><td>{1} (<a href="{2}" target="_blank" class="link">马上付款</a>)</td></tr>',$("#viewtable tr:last").hasClass("alt")?"":"alt","未支付","/web/entries/pay/"+x._id))}}if(o=="1"||$.inArray("PAYEDTIME",i)>=0){l.find("#viewtable tr.payedtime").remove();l.find("#viewtable > tbody").append($.format('<tr class="payedtime {0}"><th>支付时间</th><td>{1}</td></tr>',$("#viewtable tr:last").hasClass("alt")?"":"alt",x.PAYEDTIME||""))}}if(o=="1"||$.inArray("ID",i)>=0){l.find("#viewtable tr.id").remove();l.find("#viewtable > tbody").prepend($.format("<tr class='id'><th>ID</th><td>{0}</td></tr>",x.ID))}if(o=="1"||$.inArray("CDATE",i)>=0){l.find("#viewtable tr.cday").remove();l.find("#viewtable > tbody").prepend($.format("<tr class='cday'><th>创建日期</th><td>{0}</td></tr>",x.CDATE))}if(o=="1"||$.inArray("CTIME",i)>=0){l.find("#viewtable tr.ctime").remove();l.find("#viewtable > tbody").prepend($.format("<tr class='ctime'><th>创建时间</th><td>{0}</td></tr>",x.CTIME))}if(x.FLOWSTATUS=="2"){l.find("#viewtable tr.dowloadcontract").remove();l.find("#viewtable > tbody").append($.format("<tr class='dowloadcontract'><th>合同签署状态</th><td>{0}(<a id='download-contract' href='javascript:;' data-id='{1}'>下载合同</a>)</td></tr>","签署成功",x._id))}if(x.FLOWSTATUS=="1"||x.FLOWSTATUS=="0"){l.find("#viewtable tr.sign").remove();l.find("#viewtable > tbody").append($.format("<tr class='sign'><th>合同签署状态</th><td>{0}(<a id='sign-contract' href='javascript:;' data-id='{1}'>马上签署</a>)</td></tr>","未签署",x._id))}if((!d)&&"1"==q){l.find("#viewtable").find("td[id]").each(function(v,z){var y=$(z).html();if(!y||y=="&nbsp;"){$(z).parent().hide()}else{$(z).parent().show()}})}setTimeout(function(){if(o!=="1"||q=="1"){l.find("#viewtable > tbody").find("tr:visible").each(function(v,y){if(v%2==0){$(y).addClass("alt")}else{$(y).removeClass("alt")}})}},10)}});